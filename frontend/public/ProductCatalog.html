<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow">
    <meta name="description" content="Каталог настольных игр BoardGameHub. Купить настольные игры для компании взрослых, 
    детей, семейные и стратегические настольные игры с доставкой.">
    <title>Каталог товаров | BoardGameHub | Интернет магазин настольных игр</title>
    
    <!-- Open Graph метатеги -->
    <meta property="og:title" content="Каталог товаров | BoardGameHub">
    <meta property="og:description" content="Купить настольные игры для компании взрослых, детей, семейные и стратегические настольные игры с доставкой.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://boardgamehub.ru/catalog">
    <meta property="og:image" content="https://boardgamehub.ru/images/og-catalog.jpg">
    <meta property="og:site_name" content="BoardGameHub">
    
    <!-- Каноническая ссылка -->
    <link rel="canonical" href="https://boardgamehub.ru/catalog">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" type="image/x-icon" href="../../images/icon.png">
    
    <style>
        /* Стили для адаптивного дизайна */
        .header-logo { opacity: 0; }
        .loaded .header-logo { opacity: 1; transition: opacity 0.3s ease; }
        
        @media (prefers-reduced-motion: no-preference) {
            .hover-lift { transition: transform 0.3s ease, box-shadow 0.3s ease; }
            .hover-lift:hover { transform: translateY(-4px); box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        }
        
        .touch-target { min-width: 44px; min-height: 44px; }
        
        @media (max-width: 1024px) {
            .compact-header { padding-top: 0.75rem; padding-bottom: 0.75rem; }
        }
        
        @media (max-width: 768px) {
            .compact-nav {
                flex-wrap: wrap;
                justify-content: center;
                gap: 0.5rem;
            }
            
            .compact-nav li {
                margin: 0 0.25rem;
            }
            
            .compact-nav a {
                font-size: 0.875rem;
                padding: 0.25rem 0.5rem;
            }
        }
        
        @media (max-width: 640px) {
            .compact-nav a {
                font-size: 0.8rem;
                padding: 0.25rem;
            }
            
            .header-icons {
                margin-top: 0.5rem;
            }
        }
        
        .cart-counter {
            position: absolute;
            top: -6px;
            right: -6px;
            background-color: #f59e0b;
            color: black;
            font-size: 0.75rem;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        /* Стили для кастомных чекбоксов */
        .custom-checkbox {
            width: 18px;
            height: 18px;
            border: 2px solid #d1d5db;
            border-radius: 4px;
            cursor: pointer;
            position: relative;
            transition: all 0.2s ease;
        }

        .custom-checkbox.checked {
            background-color: #f59e0b;
            border-color: #f59e0b;
        }

        .custom-checkbox.checked::after {
            content: '✓';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 12px;
            font-weight: bold;
        }

        /* Стили для ползунка цены */
        .price-slider-container {
            position: relative;
            height: 20px;
            margin: 20px 0;
            width: 100%;
        }

        .price-slider-track {
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 4px;
            background: #e5e7eb;
            border-radius: 2px;
            transform: translateY(-50%);
        }

        .price-slider-progress {
            position: absolute;
            top: 50%;
            height: 4px;
            background: #f59e0b;
            border-radius: 2px;
            transform: translateY(-50%);
        }

        .price-slider-thumb {
            position: absolute;
            top: 50%;
            width: 18px;
            height: 18px;
            background: #f59e0b;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            cursor: pointer;
            z-index: 2;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .price-slider-thumb:hover {
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }

        .price-input-container {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .price-input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
            max-width: calc(50% - 5px);
            box-sizing: border-box;
        }

        .price-input:focus {
            outline: none;
            border-color: #f59e0b;
            box-shadow: 0 0 0 2px rgba(245, 158, 11, 0.2);
        }

        /* Фиксируем ширину блока фильтров */
        .filters-sidebar {
            width: 320px;
            min-width: 320px;
        }

        @media (max-width: 1024px) {
            .filters-sidebar {
                width: 100%;
                min-width: auto;
            }
        }
    </style>
</head>
<body class="bg-white text-gray-900">
    <!-- Header с адаптивной навигацией -->
    <header class="bg-white shadow-lg sticky top-0 z-50 compact-header">
        <div class="container mx-auto px-4 sm:px-6">
            <div class="flex flex-col lg:flex-row justify-between items-center py-3 lg:py-4 gap-3 lg:gap-4">
                <!-- Логотип -->
                <div class="text-xl lg:text-2xl font-black flex items-center header-logo">
                    <span class="text-yellow-500 mr-1">♟️</span> 
                    <span>BoardGameHub</span>
                </div>
                
                <!-- Адаптивное меню -->
                <nav class="w-full lg:w-auto">
                    <ul class="flex flex-wrap justify-center compact-nav space-x-0 lg:space-x-6 xl:space-x-8">
                        <li><a href="ProductCatalog.html" class="text-yellow-500 font-medium relative pb-1 after:content-[''] after:absolute after:bottom-0 after:left-0 after:w-full after:h-0.5 after:bg-yellow-500">Каталог товаров</a></li>
                        <li><a href="Blog.html" class="text-black font-medium relative pb-1 hover:text-yellow-500 transition-colors duration-300 after:content-[''] after:absolute after:bottom-0 after:left-0 after:w-0 after:h-0.5 after:bg-yellow-500 after:transition-all after:duration-300 hover:after:w-full">Блог</a></li>
                        <li><a href="#" class="text-black font-medium relative pb-1 hover:text-yellow-500 transition-colors duration-300 after:content-[''] after:absolute after:bottom-0 after:left-0 after:w-0 after:h-0.5 after:bg-yellow-500 after:transition-all after:duration-300 hover:after:w-full">О нас</a></li>
                        <li><a href="#" class="text-black font-medium relative pb-1 hover:text-yellow-500 transition-colors duration-300 after:content-[''] after:absolute after:bottom-0 after:left-0 after:w-0 after:h-0.5 after:bg-yellow-500 after:transition-all after:duration-300 hover:after:w-full">Доставка</a></li>
                        <li><a href="#" class="text-black font-medium relative pb-1 hover:text-yellow-500 transition-colors duration-300 after:content-[''] after:absolute after:bottom-0 after:left-0 after:w-0 after:h-0.5 after:bg-yellow-500 after:transition-all after:duration-300 hover:after:w-full">Контакты</a></li>
                    </ul>
                </nav>
                
                <!-- Иконки пользователя и корзины -->
                <div class="flex gap-3 lg:gap-4 header-icons">
                    <a href="Bag.html" class="touch-target text-black text-lg lg:text-xl hover:text-yellow-500 transition-colors duration-300 relative flex items-center justify-center">
                        <i class="fas fa-shopping-cart"></i>
                        <span class="cart-counter">0</span>
                    </a>
                    <a href="PersonalAccount.html" class="touch-target text-black text-lg lg:text-xl hover:text-yellow-500 transition-colors duration-300 flex items-center justify-center">
                        <i class="fas fa-user"></i>
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Page header -->
    <div class="bg-gray-50 py-8 lg:py-12 mb-8 lg:mb-12">
        <div class="container mx-auto px-4 sm:px-6 text-center">
            <h1 class="text-2xl sm:text-3xl lg:text-4xl font-bold mb-3 lg:mb-4">Каталог товаров</h1>
            <ul class="flex justify-center list-none" id="breadcrumb">
                <li class="mx-2 text-sm text-gray-600">
                    <a href="index.html" class="text-black hover:text-yellow-500 transition-colors duration-300">Главная</a>
                    <span class="ml-2">/</span>
                </li>
                <li class="mx-2 text-sm text-gray-600">Каталог товаров</li>
            </ul>
        </div>
    </div>

    <!-- Catalog section -->
    <section class="container mx-auto px-4 sm:px-6 mb-12 lg:mb-16">
        <!-- Mobile filters button -->
        <button id="mobileFiltersBtn" class="lg:hidden bg-yellow-500 text-black px-6 py-3 rounded font-semibold w-full mb-6 flex items-center justify-center gap-2 touch-target">
            <i class="fas fa-filter"></i> Фильтры
        </button>
        
        <div class="flex flex-col lg:flex-row gap-6 lg:gap-8">
            <!-- Filters sidebar -->
            <div id="filtersSidebar" class="filters-sidebar flex-shrink-0 hidden lg:block">
                <div class="bg-white rounded-lg shadow-lg p-4 sm:p-6 mb-6 filter-section">
                    <div class="text-lg font-semibold mb-4">Категории</div>
                    <ul class="space-y-3">
                        <li class="flex items-center">
                            <div class="custom-checkbox mr-3" data-checkbox="category-1"></div>
                            <input type="checkbox" id="category-1" class="hidden">
                            <label for="category-1" class="cursor-pointer text-gray-700 text-sm sm:text-base">Семейные игры</label>
                        </li>
                        <li class="flex items-center">
                            <div class="custom-checkbox mr-3" data-checkbox="category-2"></div>
                            <input type="checkbox" id="category-2" class="hidden">
                            <label for="category-2" class="cursor-pointer text-gray-700 text-sm sm:text-base">Стратегии</label>
                        </li>
                        <li class="flex items-center">
                            <div class="custom-checkbox mr-3" data-checkbox="category-3"></div>
                            <input type="checkbox" id="category-3" class="hidden">
                            <label for="category-3" class="cursor-pointer text-gray-700 text-sm sm:text-base">Детские игры</label>
                        </li>
                        <li class="flex items-center">
                            <div class="custom-checkbox mr-3" data-checkbox="category-4"></div>
                            <input type="checkbox" id="category-4" class="hidden">
                            <label for="category-4" class="cursor-pointer text-gray-700 text-sm sm:text-base">Кооперативные</label>
                        </li>
                        <li class="flex items-center">
                            <div class="custom-checkbox mr-3" data-checkbox="category-5"></div>
                            <input type="checkbox" id="category-5" class="hidden">
                            <label for="category-5" class="cursor-pointer text-gray-700 text-sm sm:text-base">Для вечеринок</label>
                        </li>
                    </ul>
                </div>
                
                <!-- Price Filter Block -->
                <div class="bg-white rounded-lg shadow-lg p-4 sm:p-6 mb-6 filter-section">
                    <div class="text-lg font-semibold mb-4">Цена, руб.</div>
                    <div class="space-y-4">
                        <div class="price-input-container">
                            <input type="number" id="minPrice" value="0" min="0" max="200000"
                                   class="price-input" placeholder="От">
                            <input type="number" id="maxPrice" value="200000" min="0" max="200000"
                                   class="price-input" placeholder="До">
                        </div>
                        <div class="price-slider-container">
                            <div class="price-slider-track"></div>
                            <div class="price-slider-progress" id="priceProgress"></div>
                            <div class="price-slider-thumb" id="minThumb" style="left: 0%;"></div>
                            <div class="price-slider-thumb" id="maxThumb" style="left: 100%;"></div>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-lg shadow-lg p-4 sm:p-6 mb-6 filter-section">
                    <div class="text-lg font-semibold mb-4">Количество игроков</div>
                    <ul class="space-y-3">
                        <li class="flex items-center">
                            <div class="custom-checkbox mr-3" data-checkbox="players-1"></div>
                            <input type="checkbox" id="players-1" class="hidden">
                            <label for="players-1" class="cursor-pointer text-gray-700 text-sm sm:text-base">1-2 игрока</label>
                        </li>
                        <li class="flex items-center">
                            <div class="custom-checkbox mr-3" data-checkbox="players-2"></div>
                            <input type="checkbox" id="players-2" class="hidden">
                            <label for="players-2" class="cursor-pointer text-gray-700 text-sm sm:text-base">2-4 игрока</label>
                        </li>
                        <li class="flex items-center">
                            <div class="custom-checkbox mr-3" data-checkbox="players-3"></div>
                            <input type="checkbox" id="players-3" class="hidden">
                            <label for="players-3" class="cursor-pointer text-gray-700 text-sm sm:text-base">4-6 игроков</label>
                        </li>
                        <li class="flex items-center">
                            <div class="custom-checkbox mr-3" data-checkbox="players-4"></div>
                            <input type="checkbox" id="players-4" class="hidden">
                            <label for="players-4" class="cursor-pointer text-gray-700 text-sm sm:text-base">6+ игроков</label>
                        </li>
                    </ul>
                </div>
                
                <div class="bg-white rounded-lg shadow-lg p-4 sm:p-6 mb-6 filter-section">
                    <div class="text-lg font-semibold mb-4">Возраст</div>
                    <ul class="space-y-3">
                        <li class="flex items-center">
                            <div class="custom-checkbox mr-3" data-checkbox="age-1"></div>
                            <input type="checkbox" id="age-1" class="hidden">
                            <label for="age-1" class="cursor-pointer text-gray-700 text-sm sm:text-base">3+</label>
                        </li>
                        <li class="flex items-center">
                            <div class="custom-checkbox mr-3" data-checkbox="age-2"></div>
                            <input type="checkbox" id="age-2" class="hidden">
                            <label for="age-2" class="cursor-pointer text-gray-700 text-sm sm:text-base">6+</label>
                        </li>
                        <li class="flex items-center">
                            <div class="custom-checkbox mr-3" data-checkbox="age-3"></div>
                            <input type="checkbox" id="age-3" class="hidden">
                            <label for="age-3" class="cursor-pointer text-gray-700 text-sm sm:text-base">12+</label>
                        </li>
                        <li class="flex items-center">
                            <div class="custom-checkbox mr-3" data-checkbox="age-4"></div>
                            <input type="checkbox" id="age-4" class="hidden">
                            <label for="age-4" class="cursor-pointer text-gray-700 text-sm sm:text-base">16+</label>
                        </li>
                        <li class="flex items-center">
                            <div class="custom-checkbox mr-3" data-checkbox="age-5"></div>
                            <input type="checkbox" id="age-5" class="hidden">
                            <label for="age-5" class="cursor-pointer text-gray-700 text-sm sm:text-base">18+</label>
                        </li>
                    </ul>
                </div>
                
                <div class="flex gap-3">
                    <button class="flex-1 bg-yellow-500 text-black px-4 py-3 rounded font-semibold transition-colors duration-300 hover:bg-yellow-400 touch-target text-sm sm:text-base">Применить</button>
                    <button class="flex-1 bg-gray-100 text-gray-700 px-4 py-3 rounded font-semibold transition-colors duration-300 hover:bg-gray-200 touch-target text-sm sm:text-base" id="resetFilters">Сбросить</button>
                </div>
            </div>
            
            <!-- Products section -->
            <div class="flex-1">
                <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4 mb-6">
                    <div id="productsCount" class="text-gray-600 text-sm sm:text-base">Найдено 0 товаров</div>
                    <div class="flex items-center gap-4">
                        <select id="sortSelect" class="px-4 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-yellow-500 text-sm sm:text-base touch-target">
                            <option value="popular">По популярности</option>
                            <option value="price-asc">По возрастанию цены</option>
                            <option value="price-desc">По убыванию цены</option>
                            <option value="new">По новизне</option>
                        </select>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5 lg:gap-6 xl:gap-8 mb-8" id="productsGrid">
                    <div class="col-span-full text-center py-8">
                        <i class="fas fa-spinner fa-spin text-2xl text-yellow-500 mb-2"></i>
                        <p class="text-gray-600">Загрузка товаров...</p>
                    </div>
                </div>
                
                <!-- Pagination -->
                <div class="flex justify-center gap-2">
                    <a href="#" class="w-10 h-10 bg-yellow-500 border border-yellow-500 rounded flex items-center justify-center font-semibold transition-all duration-300 hover:bg-yellow-400 touch-target text-sm">1</a>
                    <a href="#" class="w-10 h-10 bg-white border border-gray-300 rounded flex items-center justify-center font-semibold transition-all duration-300 hover:bg-yellow-500 hover:border-yellow-500 touch-target text-sm">2</a>
                    <a href="#" class="w-10 h-10 bg-white border border-gray-300 rounded flex items-center justify-center font-semibold transition-all duration-300 hover:bg-yellow-500 hover:border-yellow-500 touch-target text-sm">3</a>
                    <span class="w-10 h-10 bg-white rounded flex items-center justify-center text-gray-500 text-sm">...</span>
                    <a href="#" class="w-10 h-10 bg-white border border-gray-300 rounded flex items-center justify-center font-semibold transition-all duration-300 hover:bg-yellow-500 hover:border-yellow-500 touch-target text-sm">6</a>
                    <a href="#" class="w-10 h-10 bg-white border border-gray-300 rounded flex items-center justify-center font-semibold transition-all duration-300 hover:bg-yellow-500 hover:border-yellow-500 touch-target text-sm"><i class="fas fa-chevron-right text-sm"></i></a>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-black text-white pt-10 lg:pt-14 xl:pt-16 pb-6 lg:pb-8">
        <div class="container mx-auto px-4 sm:px-6">
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 lg:gap-8 xl:gap-10 mb-8 lg:mb-10">
                <div>
                    <h3 class="text-base sm:text-lg font-semibold mb-4 sm:mb-6 text-yellow-500">BoardGameHub</h3>
                    <p class="text-gray-300 mb-4 sm:mb-5 leading-relaxed text-sm sm:text-base">Лучший выбор настольных игр для всей семьи с доставкой по всей России. Присоединяйтесь к нашему сообществу!</p>
                    <div class="flex gap-3 sm:gap-4 mt-4 sm:mt-5">
                        <a href="#" class="touch-target w-8 h-8 sm:w-10 sm:h-10 bg-gray-800 rounded-full flex items-center justify-center transition-all duration-300 hover:bg-yellow-500 hover:text-black" aria-label="ВКонтакте"><i class="fab fa-vk text-sm sm:text-base"></i></a>
                        <a href="#" class="touch-target w-8 h-8 sm:w-10 sm:h-10 bg-gray-800 rounded-full flex items-center justify-center transition-all duration-300 hover:bg-yellow-500 hover:text-black" aria-label="Телеграм"><i class="fab fa-telegram text-sm sm:text-base"></i></a>
                        <a href="#" class="touch-target w-8 h-8 sm:w-10 sm:h-10 bg-gray-800 rounded-full flex items-center justify-center transition-all duration-300 hover:bg-yellow-500 hover:text-black" aria-label="YouTube"><i class="fab fa-youtube text-sm sm:text-base"></i></a>
                        <a href="#" class="touch-target w-8 h-8 sm:w-10 sm:h-10 bg-gray-800 rounded-full flex items-center justify-center transition-all duration-300 hover:bg-yellow-500 hover:text-black" aria-label="Instagram"><i class="fab fa-instagram text-sm sm:text-base"></i></a>
                    </div>
                </div>
                <div>
                    <h3 class="text-base sm:text-lg font-semibold mb-4 sm:mb-6 text-yellow-500">Каталог</h3>
                    <ul>
                        <li class="mb-2 sm:mb-3"><a href="#" class="text-gray-300 hover:text-yellow-500 transition-colors duration-300 text-sm sm:text-base">Семейные игры</a></li>
                        <li class="mb-2 sm:mb-3"><a href="#" class="text-gray-300 hover:text-yellow-500 transition-colors duration-300 text-sm sm:text-base">Стратегии</a></li>
                        <li class="mb-2 sm:mb-3"><a href="#" class="text-gray-300 hover:text-yellow-500 transition-colors duration-300 text-sm sm:text-base">Детские игры</a></li>
                        <li class="mb-2 sm:mb-3"><a href="#" class="text-gray-300 hover:text-yellow-500 transition-colors duration-300 text-sm sm:text-base">Кооперативные игры</a></li>
                        <li class="mb-2 sm:mb-3"><a href="#" class="text-gray-300 hover:text-yellow-500 transition-colors duration-300 text-sm sm:text-base">Для вечеринок</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-base sm:text-lg font-semibold mb-4 sm:mb-6 text-yellow-500">Информация</h3>
                    <ul>
                        <li class="mb-2 sm:mb-3"><a href="#" class="text-gray-300 hover:text-yellow-500 transition-colors duration-300 text-sm sm:text-base">О нас</a></li>
                        <li class="mb-2 sm:mb-3"><a href="#" class="text-gray-300 hover:text-yellow-500 transition-colors duration-300 text-sm sm:text-base">Доставка и оплата</a></li>
                        <li class="mb-2 sm:mb-3"><a href="#" class="text-gray-300 hover:text-yellow-500 transition-colors duration-300 text-sm sm:text-base">Контакты</a></li>
                        <li class="mb-2 sm:mb-3"><a href="Blog.html" class="text-gray-300 hover:text-yellow-500 transition-colors duration-300 text-sm sm:text-base">Блог</a></li>
                        <li class="mb-2 sm:mb-3"><a href="#" class="text-gray-300 hover:text-yellow-500 transition-colors duration-300 text-sm sm:text-base">Акции</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-base sm:text-lg font-semibold mb-4 sm:mb-6 text-yellow-500">Контакты</h3>
                    <ul class="space-y-3 sm:space-y-4">
                        <li class="flex items-center gap-3 sm:gap-4 text-gray-300 text-sm sm:text-base"><i class="fas fa-map-marker-alt"></i> Москва, ул. Игровая, 15</li>
                        <li class="flex items-center gap-3 sm:gap-4 text-gray-300 text-sm sm:text-base"><i class="fas fa-phone"></i> +7 (495) 123-45-67</li>
                        <li class="flex items-center gap-3 sm:gap-4 text-gray-300 text-sm sm:text-base"><i class="fas fa-envelope"></i> info@boardgamehub.ru</li>
                    </ul>
                </div>
            </div>
            <div class="pt-6 sm:pt-8 border-t border-gray-800 text-center text-gray-400 text-xs sm:text-sm">
                <p>&copy; 2023 BoardGameHub. Все права защищены.</p>
            </div>
        </div>
    </footer>

    <script type="module">
        // Импорт необходимых модулей Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js";
        import { getDatabase, ref, get } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-database.js";

        // Конфигурация Firebase для веб-приложения
        const firebaseConfig = {
            apiKey: "AIzaSyDuYb4O0s7accu6T5MSbJ6WUiSpwnJI6gk",
            authDomain: "gamestore-8a2a3.firebaseapp.com",
            databaseURL: "https://gamestore-8a2a3-default-rtdb.firebaseio.com",
            projectId: "gamestore-8a2a3",
            storageBucket: "gamestore-8a2a3.firebasestorage.app",
            messagingSenderId: "630285121213",
            appId: "1:630285121213:web:6cc7f2cc0350e0f020e9d4",
            measurementId: "G-3EXSGX4EWJ"
        };

        // Инициализация Firebase
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        let allProducts = [];
        let isDragging = false;
        let activeThumb = null;
        const MAX_PRICE = 200000;

        // Функция для работы с кастомными чекбоксами
        function initializeCustomCheckboxes() {
            const checkboxes = document.querySelectorAll('.custom-checkbox');
            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('click', function() {
                    const checkboxId = this.getAttribute('data-checkbox');
                    const realCheckbox = document.getElementById(checkboxId);
                    
                    if (realCheckbox) {
                        realCheckbox.checked = !realCheckbox.checked;
                        this.classList.toggle('checked', realCheckbox.checked);
                    }
                });
            });
        }

        // Функция для сброса всех фильтров
        function resetAllFilters() {
            // Сбрасываем чекбоксы
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach(checkbox => {
                checkbox.checked = false;
            });
            
            const customCheckboxes = document.querySelectorAll('.custom-checkbox');
            customCheckboxes.forEach(checkbox => {
                checkbox.classList.remove('checked');
            });
            
            // Сбрасываем цену
            document.getElementById('minPrice').value = 0;
            document.getElementById('maxPrice').value = MAX_PRICE;
            updatePriceSlider();
        }

        // Функция для обновления ползунка цены
        // Функция для инициализации ползунка цены
function initializePriceSlider() {
    const minThumb = document.getElementById('minThumb');
    const maxThumb = document.getElementById('maxThumb');
    const sliderContainer = document.querySelector('.price-slider-container');
    const minPriceInput = document.getElementById('minPrice');
    const maxPriceInput = document.getElementById('maxPrice');
    
    function getPositionFromEvent(event) {
        const rect = sliderContainer.getBoundingClientRect();
        const x = event.type.includes('touch') ? event.touches[0].clientX : event.clientX;
        return Math.max(0, Math.min(100, ((x - rect.left) / rect.width) * 100));
    }
    
    function updatePriceFromPosition(percent, isMin) {
        const price = Math.round((percent / 100) * MAX_PRICE);
        if (isMin) {
            const maxPrice = parseInt(maxPriceInput.value) || MAX_PRICE;
            if (price <= maxPrice) {
                minPriceInput.value = price;
            } else {
                minPriceInput.value = maxPrice;
            }
        } else {
            const minPrice = parseInt(minPriceInput.value) || 0;
            if (price >= minPrice) {
                maxPriceInput.value = price;
            } else {
                maxPriceInput.value = minPrice;
            }
        }
        updatePriceSlider();
    }
    
    function startDrag(event, thumb) {
        event.preventDefault();
        isDragging = true;
        activeThumb = thumb;
        
        document.addEventListener('mousemove', onDrag);
        document.addEventListener('touchmove', onDrag);
        document.addEventListener('mouseup', stopDrag);
        document.addEventListener('touchend', stopDrag);
    }
    
    function onDrag(event) {
        if (!isDragging) return;
        
        const percent = getPositionFromEvent(event);
        const isMin = activeThumb === minThumb;
        updatePriceFromPosition(percent, isMin);
    }
    
    function stopDrag() {
        isDragging = false;
        activeThumb = null;
        
        document.removeEventListener('mousemove', onDrag);
        document.removeEventListener('touchmove', onDrag);
        document.removeEventListener('mouseup', stopDrag);
        document.removeEventListener('touchend', stopDrag);
    }
    
    // Обработчики для ползунков
    minThumb.addEventListener('mousedown', (e) => startDrag(e, minThumb));
    maxThumb.addEventListener('mousedown', (e) => startDrag(e, maxThumb));
    minThumb.addEventListener('touchstart', (e) => startDrag(e, minThumb));
    maxThumb.addEventListener('touchstart', (e) => startDrag(e, maxThumb));
    
    // Обработчики для полей ввода с дебаунсом
    let inputTimeout;
    function handlePriceInput() {
        clearTimeout(inputTimeout);
        inputTimeout = setTimeout(() => {
            const minPrice = parseInt(minPriceInput.value) || 0;
            const maxPrice = parseInt(maxPriceInput.value) || MAX_PRICE;
            
            // Корректируем значения если min > max
            if (minPrice > maxPrice) {
                if (this === minPriceInput) {
                    minPriceInput.value = maxPrice;
                } else {
                    maxPriceInput.value = minPrice;
                }
            }
            
            // Ограничиваем значения
            minPriceInput.value = Math.max(0, Math.min(MAX_PRICE, minPriceInput.value));
            maxPriceInput.value = Math.max(0, Math.min(MAX_PRICE, maxPriceInput.value));
            
            updatePriceSlider();
        }, 300);
    }
    
    minPriceInput.addEventListener('input', handlePriceInput);
    maxPriceInput.addEventListener('input', handlePriceInput);
    
    // Обработчики для blur (мгновенное обновление при уходе с поля)
    minPriceInput.addEventListener('blur', function() {
        const minPrice = parseInt(this.value) || 0;
        const maxPrice = parseInt(maxPriceInput.value) || MAX_PRICE;
        
        if (minPrice > maxPrice) {
            this.value = maxPrice;
        }
        this.value = Math.max(0, Math.min(MAX_PRICE, this.value));
        updatePriceSlider();
    });
    
    maxPriceInput.addEventListener('blur', function() {
        const minPrice = parseInt(minPriceInput.value) || 0;
        const maxPrice = parseInt(this.value) || MAX_PRICE;
        
        if (maxPrice < minPrice) {
            this.value = minPrice;
        }
        this.value = Math.max(0, Math.min(MAX_PRICE, this.value));
        updatePriceSlider();
    });
    
    // Инициализация начального состояния
    updatePriceSlider();
}

// Функция для обновления ползунка цены
function updatePriceSlider() {
    const minPrice = parseInt(document.getElementById('minPrice').value) || 0;
    const maxPrice = parseInt(document.getElementById('maxPrice').value) || MAX_PRICE;
    
    // Корректируем значения если min > max
    if (minPrice > maxPrice) {
        document.getElementById('minPrice').value = maxPrice;
        document.getElementById('maxPrice').value = minPrice;
    }
    
    // Ограничиваем значения
    const clampedMinPrice = Math.max(0, Math.min(MAX_PRICE, minPrice));
    const clampedMaxPrice = Math.max(0, Math.min(MAX_PRICE, maxPrice));
    
    const minPercent = (clampedMinPrice / MAX_PRICE) * 100;
    const maxPercent = (clampedMaxPrice / MAX_PRICE) * 100;
    
    const minThumb = document.getElementById('minThumb');
    const maxThumb = document.getElementById('maxThumb');
    const progress = document.getElementById('priceProgress');
    
    minThumb.style.left = `${minPercent}%`;
    maxThumb.style.left = `${maxPercent}%`;
    
    progress.style.left = `${minPercent}%`;
    progress.style.right = `${100 - maxPercent}%`;
    
    // Обновляем значения в полях ввода
    document.getElementById('minPrice').value = clampedMinPrice;
    document.getElementById('maxPrice').value = clampedMaxPrice;
}
        // Функция сортировки товаров
        function sortProducts(products, sortType) {
            const sortedProducts = [...products];
            
            switch(sortType) {
                case 'price-asc':
                    return sortedProducts.sort((a, b) => (a.Price || 0) - (b.Price || 0));
                case 'price-desc':
                    return sortedProducts.sort((a, b) => (b.Price || 0) - (a.Price || 0));
                case 'new':
                    return sortedProducts.sort((a, b) => (b.id || 0) - (a.id || 0));
                case 'popular':
                default:
                    return sortedProducts;
            }
        }

        async function loadProducts() {
            try {
                const productsRef = ref(db, 'Products');
                const snapshot = await get(productsRef);
                const productsGrid = document.getElementById('productsGrid');
                const productsCount = document.getElementById('productsCount');
                
                if (productsGrid) {
                    productsGrid.innerHTML = '';
                } else {
                    console.error("Products grid element not found");
                    return;
                }

                if (snapshot.exists()) {
                    const products = snapshot.val();
                    
                    allProducts = Object.entries(products)
                        .sort(([id1], [id2]) => id1 - id2)
                        .map(([id, product]) => ({ id, ...product }));

                    // Применяем сортировку по умолчанию
                    const sortSelect = document.getElementById('sortSelect');
                    const sortedProducts = sortProducts(allProducts, sortSelect.value);

                    // Обновляем счетчик товаров
                    if (productsCount) {
                        productsCount.textContent = `Найдено ${sortedProducts.length} товаров`;
                    }

                    for (const product of sortedProducts) {
                        await createProductCard(product, productsGrid);
                    }
                } else {
                    productsGrid.innerHTML = '<div class="col-span-full text-center py-8"><p class="text-gray-600">Товары не найдены</p></div>';
                    if (productsCount) {
                        productsCount.textContent = 'Найдено 0 товаров';
                    }
                    console.log("No products available");
                }
            } catch (error) {
                console.error("Error loading products:", error);
                const productsGrid = document.getElementById('productsGrid');
                const productsCount = document.getElementById('productsCount');
                if (productsGrid) {
                    productsGrid.innerHTML = '<div class="col-span-full text-center py-8"><p class="text-red-500">Ошибка загрузки товаров</p></div>';
                }
                if (productsCount) {
                    productsCount.textContent = 'Ошибка загрузки';
                }
            }
        }

        async function createProductCard(product, container) {
            try {
                const productCard = document.createElement('div');
                productCard.className = 'bg-white rounded-lg shadow-lg hover-lift';
                
                // Используем URL изображения из базы данных или заглушку
                const imageUrl = product.Image ? `C:\\Users\\user\\Desktop\\учёба\\Веб\\GameSite\\images\\${product.Image}` : 'C:\\Users\\user\\Desktop\\учёба\\Веб\\GameSite\\images\\placeholder.jpg';

                productCard.innerHTML = `
                    <img src="${imageUrl}" 
                         alt="${product.Name || 'Product'}" 
                         class="w-full h-40 sm:h-48 object-cover border-b-4 border-yellow-500" loading="lazy">
                    <div class="p-4 sm:p-5">
                        <h3 class="text-base sm:text-lg font-semibold mb-2 sm:mb-3">${product.Name || 'Без названия'}</h3>
                        <p class="text-gray-600 mb-3 sm:mb-4 text-xs sm:text-sm">${product.Description || 'Описание отсутствует'}</p>
                        <div class="flex justify-between items-center mb-3 sm:mb-4">
                            <span class="text-lg sm:text-xl font-bold">${product.Price || '0'} ₽</span>
                            ${product.Discount ? `<span class="bg-yellow-500 text-black px-2 py-1 sm:px-3 sm:py-1 rounded-full text-xs sm:text-sm">-${product.Discount}%</span>` : ''}
                        </div>
                        <a href="#" class="block w-full bg-yellow-500 text-black px-4 py-2 sm:px-6 sm:py-3 rounded font-semibold text-xs sm:text-sm text-center transition-all duration-300 hover:bg-yellow-400 touch-target">В корзину</a>
                    </div>
                `;

                container.appendChild(productCard);
            } catch (error) {
                console.error("Error creating product card:", error);
            }
        }

        // Загружаем продукты при загрузке страницы
        document.addEventListener('DOMContentLoaded', () => {
            // Отметка о загрузке страницы для анимаций
            document.body.classList.add('loaded');
            
            // Инициализация компонентов
            initializeCustomCheckboxes();
            initializePriceSlider();
            
            // Загрузка товаров
            loadProducts().catch(error => {
                console.error("Initial load error:", error);
            });

            // Обработчик сортировки
            document.getElementById('sortSelect').addEventListener('change', function() {
                const sortedProducts = sortProducts(allProducts, this.value);
                const productsGrid = document.getElementById('productsGrid');
                const productsCount = document.getElementById('productsCount');
                
                if (productsGrid) {
                    productsGrid.innerHTML = '';
                    sortedProducts.forEach(product => createProductCard(product, productsGrid));
                }
                
                if (productsCount) {
                    productsCount.textContent = `Найдено ${sortedProducts.length} товаров`;
                }
            });

            // Обработчик сброса фильтров
            document.getElementById('resetFilters').addEventListener('click', resetAllFilters);
        });

        // Mobile filters toggle
        document.getElementById('mobileFiltersBtn').addEventListener('click', function() {
            const filters = document.getElementById('filtersSidebar');
            filters.classList.toggle('hidden');
        });
    </script>

    <script src="cart.js"></script>
</body>
</html>